# FFMPEG MCP Server - CI-optimized using pre-built base
FROM ghcr.io/stiglau/yolo-ffmpeg-mcp:base-latest

# Install only essential dependencies for CI testing
RUN pip install --no-cache-dir --root-user-action=ignore \
    pytest>=8.4.0 \
    pytest-asyncio>=1.0.0

# Copy source code and test files
COPY src/ ./src/
COPY tests/ci/test_unit_core.py ./

# Default command - run basic CI test
CMD ["python", "-m", "pytest", "test_unit_core.py", "-v"]

# Labels
LABEL maintainer="Stig Lau" \
      version="1.0.0-ci" \
      description="FFMPEG MCP Server - CI Build (Lightweight)"